/** * NEXUS Platform - Jest Configuration * Comprehensive test configuration for all test suites */ module.exports = { testEnvironment: 'jsdom', extensionsToTreatAsEsm: ['.ts', '.tsx'], setupFilesAfterEnv: ['<rootDir>/unified-frontend/src/setupTests.tsx'], moduleNameMapper: { '^@/(.*)$': '<rootDir>/unified-frontend/src/$1', '^@nexus/shared$': '<rootDir>/src/shared', }, testMatch: [ '<rootDir>/src/frontend/src/**/__tests__/**/*.{js,jsx,ts,tsx}', '<rootDir>/src/frontend/src/**/*.{test,spec}.{js,jsx,ts,tsx}', '<rootDir>/src/frontend/src/**/tests/**/*.{js,jsx,ts,tsx}', '<rootDir>/unified-frontend/src/**/__tests__/**/*.{js,jsx,ts,tsx}', '<rootDir>/unified-frontend/src/**/*.{test,spec}.{js,jsx,ts,tsx}', '<rootDir>/unified-frontend/src/**/tests/**/*.{js,jsx,ts,tsx}', ], collectCoverage: true, coverageDirectory: 'coverage', coverageReporters: ['text', 'lcov', 'html', 'json'], coverageThreshold: { global: { branches: 80, functions: 80, lines: 80, statements: 80, }, }, collectCoverageFrom: [ 'unified-frontend/src/**/*.{js,jsx,ts,tsx}', '!unified-frontend/src/**/*.d.ts', '!unified-frontend/src/**/*.stories.{js,jsx,ts,tsx}', '!unified-frontend/src/**/*.test.{js,jsx,ts,tsx}', '!unified-frontend/src/**/*.spec.{js,jsx,ts,tsx}', '!unified-frontend/src/**/__tests__/**', '!unified-frontend/src/**/tests/**', '!unified-frontend/src/**/node_modules/**', ], transform: { '^.+\\.(js|jsx|ts|tsx)$': 'babel-jest', '^.+\\.css$': 'jest-transform-stub', '^.+\\.(png|jpg|jpeg|gif|svg)$': 'jest-transform-stub', }, moduleFileExtensions: ['js', 'jsx', 'ts', 'tsx', 'json', 'node'], transformIgnorePatterns: [ 'node_modules/(?!(.*\\.mjs$|@tanstack|@testing-library|react-router-dom))', ], testTimeout: 10000, verbose: true, clearMocks: true, restoreMocks: true, resetModules: true, testEnvironmentOptions: { url: 'http: }, modulePaths: ['<rootDir>/unified-frontend/src'], errorOnDeprecated: true, forceExit: true, detectOpenHandles: true, detectLeaks: true, logHeapUsage: true, maxWorkers: '50%', cache: true, cacheDirectory: '<rootDir>/.jest-cache', lastCommit: false, listTests: false, passWithNoTests: true, showSeed: false, updateSnapshot: false, useStderr: false, watchAll: false, watchman: true, projects: [ { displayName: 'frontend', testMatch: ['<rootDir>/unified-frontend/src/**/*.{test,spec}.{js,jsx,ts,tsx}'], testEnvironment: 'jsdom', setupFilesAfterEnv: ['<rootDir>/unified-frontend/src/setupTests.tsx'], moduleNameMapper: { '^@/(.*)$': '<rootDir>/unified-frontend/src/$1', '^@nexus/shared$': '<rootDir>/src/shared', }, transform: { '^.+\\.(js|jsx|ts|tsx)$': 'babel-jest', '^.+\\.css$': 'jest-transform-stub', '^.+\\.(png|jpg|jpeg|gif|svg)$': 'jest-transform-stub', }, transformIgnorePatterns: [ 'node_modules/(?!(.*\\.mjs$|@tanstack|@testing-library|react-router-dom))', ], }, { displayName: 'backend', testMatch: ['<rootDir>/src/backend/**/*.{test,spec}.{js,ts}'], testEnvironment: 'node', moduleNameMapper: { '^@/(.*)$': '<rootDir>/src/backend/$1', }, transform: { '^.+\\.(js|ts)$': 'babel-jest', }, }, ], coveragePathIgnorePatterns: [ '/node_modules/', '/coverage/', '/dist/', '/build/', '/.next/', '/.nuxt/', '/.vuepress/', '/.temp/', '/.cache/', '/.nyc_output/', '/.jest/', '/.eslintcache/', '/.stylelintcache/', '/.prettiercache/', '/.rollup.cache/', '/.vite/', '/.swc/', '/.turbo/', '/.next/', '/.nuxt/', '/.vuepress/', '/.temp/', '/.cache/', '/.nyc_output/', '/.jest/', '/.eslintcache/', '/.stylelintcache/', '/.prettiercache/', '/.rollup.cache/', '/.vite/', '/.swc/', '/.turbo/', ], testPathIgnorePatterns: [ '/node_modules/', '/coverage/', '/dist/', '/build/', '/.next/', '/.nuxt/', '/.vuepress/', '/.temp/', '/.cache/', '/.nyc_output/', '/.jest/', '/.eslintcache/', '/.stylelintcache/', '/.prettiercache/', '/.rollup.cache/', '/.vite/', '/.swc/', '/.turbo/', ], watchPathIgnorePatterns: [ '/node_modules/', '/coverage/', '/dist/', '/build/', '/.next/', '/.nuxt/', '/.vuepress/', '/.temp/', '/.cache/', '/.nyc_output/', '/.jest/', '/.eslintcache/', '/.stylelintcache/', '/.prettiercache/', '/.rollup.cache/', '/.vite/', '/.swc/', '/.turbo/', ], };
